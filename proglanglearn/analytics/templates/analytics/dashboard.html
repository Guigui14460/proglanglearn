{% extends 'analytics/base_analytic.html' %}
{% load static i18n js %}

{% block title %}{% trans "Tableau de bord" %} - {% endblock title %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'style/css/Chart.min.css' %}">
<style>
.dashboard-grid {display: grid; grid-gap: 10px; grid-template-columns: 1fr 1fr;}
@media screen and (max-width: 1050px){.dashboard-grid{grid-template-columns: 1fr;}}
</style>
{% endblock extra_head %}

{% block main %}
<h1 class="large">{% trans "Tableau de bord" %}</h1>
<div class="dashboard-grid">
    <div class="card card-hoverable">
        <div class="card-container">
            <h3 class="card-title center-text mb-1">{% trans "Progression" %}</h3>
            <div class="card-content">
                <div class="piechart-container">
                    <div class="box">
                        <div class="chart" data-percent="{{ level_percent }}">{{ level_experience }}</div>
                        <h2>{% trans "Niveau" %} {{ level }}</h2>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card card-hoverable">
        <div class="card-container">
            <h3 class="card-title center-text">{% trans "Signalements" %}</h3>
            <div class="card-content m-1 mt-2">
                {{ strike|safe }}
            </div>
        </div>
    </div>
</div>
<div class="card card-hoverable my-1">
    <div class="card-container">
        <h3 class="card-title center-text">{% trans "Expérience gagnée cette dernière semaine" %}</h3>
        <div class="card-content">
            <div style="position: relative; width: 100%; height: auto;">
                <canvas id="chart1"></canvas>
            </div>
        </div>
    </div>
</div>
{% endblock main %}

{% block javascript %}
<script src="{% static 'js/jquery.easypiechart.min.js' %}"></script>
<script src="{% static 'js/Chart.min.js' %}"></script>
<script src="{% static 'js/utils.js' %}"></script>
{% endblock javascript %}

{% block jquery %}
$('.chart').easyPieChart({
    easing: 'easeOutBounce',
    barColor: "#1780e8",
    lineWidth: 12,
    size: 160,
    scaleColor: false,
    trackColor: '#a0a0a0',
    lineCap: 'circle',
    animate: 1150,
});
var color = Chart.helpers.color;
var barChartData = {
    labels: {{ label|js }},
    datasets: [{
        label: '{% trans "Expérience" %}',
        backgroundColor: color(window.chartColors.orange).alpha(0.5).rgbString(),
        borderColor: window.chartColors.orange,
        borderWidth: 1,
        data: {{ data|js }},
    }]
}
window.onload = function () {
    var ctx1 = $('#chart1');
    window.myBar = new Chart(ctx1, {
        type: 'bar',
        data: barChartData,
        options: {
            responsive: true,
            legend: {
                display: false,
            },
        }
    });
};
{% endblock jquery %}
